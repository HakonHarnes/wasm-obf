/* Generated by CIL v. %%VERSION_NUM%% */
/* print_CIL_Input is true */

#line 139 "/usr/local/bin/emcc-non-obf/emscripten/cache/sysroot/include/bits/alltypes.h"
typedef unsigned long size_t;
#line 81 "/usr/local/bin/emcc-non-obf/emscripten/cache/sysroot/include/bits/alltypes.h"
typedef long long time_t;
#line 46 "/usr/local/bin/emcc-non-obf/llvm/build/lib/clang/16/include/stddef.h"
typedef unsigned long size_t___0;
#line 190 "/usr/local/bin/emcc-non-obf/emscripten/cache/sysroot/include/bits/alltypes.h"
typedef long long int64_t;
#line 200 "/usr/local/bin/emcc-non-obf/emscripten/cache/sysroot/include/bits/alltypes.h"
typedef unsigned char uint8_t;
#line 215 "/usr/local/bin/emcc-non-obf/emscripten/cache/sysroot/include/bits/alltypes.h"
typedef unsigned long long uint64_t;
#line 241 "/usr/local/bin/emcc-non-obf/emscripten/cache/sysroot/include/bits/alltypes.h"
typedef long long off_t;
#line 398
struct _IO_FILE ;
#line 398 "/usr/local/bin/emcc-non-obf/emscripten/cache/sysroot/include/bits/alltypes.h"
typedef struct _IO_FILE FILE;
#line 410 "/usr/local/bin/emcc-non-obf/emscripten/cache/sysroot/include/zconf.h"
typedef void *voidp;
#line 1302 "/usr/local/bin/emcc-non-obf/emscripten/cache/sysroot/include/zlib.h"
struct gzFile_s ;
#line 1302 "/usr/local/bin/emcc-non-obf/emscripten/cache/sysroot/include/zlib.h"
typedef struct gzFile_s *gzFile;
#line 1834 "/usr/local/bin/emcc-non-obf/emscripten/cache/sysroot/include/zlib.h"
struct gzFile_s {
   unsigned int have ;
   unsigned char *next ;
   off_t pos ;
};
#line 85 "./kseq.h"
struct __kstring_t {
   size_t___0 l ;
   size_t___0 m ;
   char *s ;
};
#line 85 "./kseq.h"
typedef struct __kstring_t kstring_t;
#line 42 "wgsim.c"
struct __kstream_t {
   unsigned char *buf ;
   int begin ;
   int end ;
   int is_eof ;
   gzFile f ;
};
#line 42 "wgsim.c"
typedef struct __kstream_t kstream_t;
#line 42 "wgsim.c"
struct __anonstruct_kseq_t_745567265 {
   kstring_t name ;
   kstring_t comment ;
   kstring_t seq ;
   kstring_t qual ;
   int last_char ;
   kstream_t *f ;
};
#line 42 "wgsim.c"
typedef struct __anonstruct_kseq_t_745567265 kseq_t;
#line 91 "wgsim.c"
typedef unsigned short mut_t;
#line 94 "wgsim.c"
struct __anonstruct_mutseq_t_298841796 {
   int l ;
   int m ;
   mut_t *s ;
};
#line 94 "wgsim.c"
typedef struct __anonstruct_mutseq_t_298841796 mutseq_t;
#line 23 "/usr/local/bin/emcc-non-obf/emscripten/cache/sysroot/include/stdlib.h"
extern int atoi(char const   * ) ;
#line 26
extern double atof(char const   * ) ;
#line 40
extern void *malloc(size_t  ) ;
#line 41
extern void *calloc(size_t  , size_t  ) ;
#line 42
extern void *realloc(void * , size_t  ) ;
#line 43
extern void free(void * ) ;
#line 128
extern double drand48(void) ;
#line 134
extern void srand48(long  ) ;
#line 259 "/usr/local/bin/emcc-non-obf/emscripten/cache/sysroot/include/math.h"
extern double log(double  ) ;
#line 343
extern double sqrt(double  ) ;
#line 55 "/usr/local/bin/emcc-non-obf/emscripten/cache/sysroot/include/time.h"
extern time_t time(time_t * ) ;
#line 74 "/usr/local/bin/emcc-non-obf/emscripten/cache/sysroot/include/stdio.h"
extern FILE *stderr ;
#line 80
extern FILE *fopen(char const   * __restrict   , char const   * __restrict   ) ;
#line 82
extern int fclose(FILE * ) ;
#line 107
extern int fputc(int  , FILE * ) ;
#line 109
extern int putchar(int  ) ;
#line 119
extern int printf(char const   * __restrict    , ...) ;
#line 120
extern int fprintf(FILE * __restrict   , char const   * __restrict    , ...) ;
#line 137 "/usr/local/bin/emcc-non-obf/emscripten/cache/sysroot/include/unistd.h"
extern int getopt(int  , char ** , char const   * ) ;
#line 138
extern char *optarg ;
#line 139
extern int optind ;
#line 15 "/usr/local/bin/emcc-non-obf/emscripten/cache/sysroot/include/ctype.h"
extern int isgraph(int  ) ;
#line 19
extern int isspace(int  ) ;
#line 27 "/usr/local/bin/emcc-non-obf/emscripten/cache/sysroot/include/string.h"
extern void *memcpy(void * __restrict   , void const   * __restrict   , size_t___0  ) ;
#line 1392 "/usr/local/bin/emcc-non-obf/emscripten/cache/sysroot/include/zlib.h"
extern int gzread(gzFile file , voidp buf , unsigned int len ) ;
#line 1631
extern int gzclose(gzFile file ) ;
#line 1893
extern gzFile gzopen(char const   * , char const   * ) ;
#line 42 "wgsim.c"
__inline static kstream_t *ks_init(gzFile f ) 
{ 
  kstream_t *ks ;
  void *tmp ;
  void *tmp___0 ;

  {
#line 42
  tmp = calloc((size_t )1, sizeof(kstream_t ));
#line 42
  ks = (kstream_t *)tmp;
#line 42
  ks->f = f;
#line 42
  tmp___0 = malloc((size_t )4096);
#line 42
  ks->buf = (unsigned char *)tmp___0;
#line 42
  return (ks);
}
}
#line 42 "wgsim.c"
__inline static void ks_destroy(kstream_t *ks ) 
{ 


  {
#line 42
  if (ks) {
#line 42
    free((void *)ks->buf);
#line 42
    free((void *)ks);
  }
#line 42
  return;
}
}
#line 42 "wgsim.c"
__inline static int ks_getc(kstream_t *ks ) 
{ 
  int tmp ;

  {
#line 42
  if (ks->is_eof) {
#line 42
    if (ks->begin >= ks->end) {
#line 42
      return (-1);
    }
  }
#line 42
  if (ks->begin >= ks->end) {
#line 42
    ks->begin = 0;
#line 42
    ks->end = gzread(ks->f, (voidp )ks->buf, 4096U);
#line 42
    if (ks->end < 4096) {
#line 42
      ks->is_eof = 1;
    }
#line 42
    if (ks->end == 0) {
#line 42
      return (-1);
    }
  }
#line 42
  tmp = ks->begin;
#line 42
  (ks->begin) ++;
#line 42
  return ((int )*(ks->buf + tmp));
}
}
#line 42 "wgsim.c"
static int ks_getuntil(kstream_t *ks , int delimiter , kstring_t *str , int *dret ) 
{ 
  int i ;
  int tmp ;
  int tmp___0 ;
  void *tmp___1 ;
  void *tmp___2 ;

  {
#line 42
  if (dret) {
#line 42
    *dret = 0;
  }
#line 42
  str->l = (size_t___0 )0;
#line 42
  if (ks->begin >= ks->end) {
#line 42
    if (ks->is_eof) {
#line 42
      return (-1);
    }
  }
#line 42
  while (1) {
#line 42
    if (ks->begin >= ks->end) {
#line 42
      if (! ks->is_eof) {
#line 42
        ks->begin = 0;
#line 42
        ks->end = gzread(ks->f, (voidp )ks->buf, 4096U);
#line 42
        if (ks->end < 4096) {
#line 42
          ks->is_eof = 1;
        }
#line 42
        if (ks->end == 0) {
#line 42
          break;
        }
      } else {
#line 42
        break;
      }
    }
#line 42
    if (delimiter > 1) {
#line 42
      i = ks->begin;
#line 42
      while (i < ks->end) {
#line 42
        if ((int )*(ks->buf + i) == delimiter) {
#line 42
          break;
        }
#line 42
        i ++;
      }
    } else
#line 42
    if (delimiter == 0) {
#line 42
      i = ks->begin;
#line 42
      while (i < ks->end) {
#line 42
        tmp = isspace((int )*(ks->buf + i));
#line 42
        if (tmp) {
#line 42
          break;
        }
#line 42
        i ++;
      }
    } else
#line 42
    if (delimiter == 1) {
#line 42
      i = ks->begin;
#line 42
      while (i < ks->end) {
#line 42
        tmp___0 = isspace((int )*(ks->buf + i));
#line 42
        if (tmp___0) {
#line 42
          if ((int )*(ks->buf + i) != 32) {
#line 42
            break;
          }
        }
#line 42
        i ++;
      }
    } else {
#line 42
      i = 0;
    }
#line 42
    if (str->m - str->l < (size_t___0 )((i - ks->begin) + 1)) {
#line 42
      str->m = (str->l + (size_t___0 )(i - ks->begin)) + 1UL;
#line 42
      (str->m) --;
#line 42
      str->m |= str->m >> 1;
#line 42
      str->m |= str->m >> 2;
#line 42
      str->m |= str->m >> 4;
#line 42
      str->m |= str->m >> 8;
#line 42
      str->m |= str->m >> 16;
#line 42
      (str->m) ++;
#line 42
      tmp___1 = realloc((void *)str->s, str->m);
#line 42
      str->s = (char *)tmp___1;
    }
#line 42
    memcpy((void * __restrict  )(str->s + str->l), (void const   * __restrict  )(ks->buf + ks->begin),
           (size_t___0 )(i - ks->begin));
#line 42
    str->l += (size_t___0 )(i - ks->begin);
#line 42
    ks->begin = i + 1;
#line 42
    if (i < ks->end) {
#line 42
      if (dret) {
#line 42
        *dret = (int )*(ks->buf + i);
      }
#line 42
      break;
    }
  }
#line 42
  if (str->l == 0UL) {
#line 42
    str->m = (size_t___0 )1;
#line 42
    tmp___2 = calloc((size_t )1, (size_t )1);
#line 42
    str->s = (char *)tmp___2;
  }
#line 42
  *(str->s + str->l) = (char )'\000';
#line 42
  return ((int )str->l);
}
}
#line 42 "wgsim.c"
__inline static kseq_t *kseq_init(gzFile fd ) 
{ 
  kseq_t *s ;
  void *tmp ;

  {
#line 42
  tmp = calloc((size_t )1, sizeof(kseq_t ));
#line 42
  s = (kseq_t *)tmp;
#line 42
  s->f = ks_init(fd);
#line 42
  return (s);
}
}
#line 42 "wgsim.c"
__inline static void kseq_destroy(kseq_t *ks ) 
{ 


  {
#line 42
  if (! ks) {
#line 42
    return;
  }
#line 42
  free((void *)ks->name.s);
#line 42
  free((void *)ks->comment.s);
#line 42
  free((void *)ks->seq.s);
#line 42
  free((void *)ks->qual.s);
#line 42
  ks_destroy(ks->f);
#line 42
  free((void *)ks);
#line 42
  return;
}
}
#line 42 "wgsim.c"
static int kseq_read(kseq_t *seq ) 
{ 
  int c ;
  kstream_t *ks ;
  size_t___0 tmp ;
  size_t___0 tmp___0 ;
  int tmp___1 ;
  void *tmp___2 ;
  size_t___0 tmp___3 ;
  int tmp___4 ;
  void *tmp___5 ;
  size_t___0 tmp___6 ;

  {
#line 42
  ks = seq->f;
#line 42
  if (seq->last_char == 0) {
#line 42
    while (1) {
#line 42
      c = ks_getc(ks);
#line 42
      if (c != -1) {
#line 42
        if (c != 62) {
#line 42
          if (! (c != 64)) {
#line 42
            break;
          }
        } else {
#line 42
          break;
        }
      } else {
#line 42
        break;
      }
    }
#line 42
    if (c == -1) {
#line 42
      return (-1);
    }
#line 42
    seq->last_char = c;
  }
#line 42
  tmp___0 = (size_t___0 )0;
#line 42
  seq->qual.l = tmp___0;
#line 42
  tmp = tmp___0;
#line 42
  seq->seq.l = tmp;
#line 42
  seq->comment.l = tmp;
#line 42
  tmp___1 = ks_getuntil(ks, 0, & seq->name, & c);
#line 42
  if (tmp___1 < 0) {
#line 42
    return (-1);
  }
#line 42
  if (c != 10) {
#line 42
    ks_getuntil(ks, '\n', & seq->comment, (int *)0);
  }
#line 42
  while (1) {
#line 42
    c = ks_getc(ks);
#line 42
    if (c != -1) {
#line 42
      if (c != 62) {
#line 42
        if (c != 43) {
#line 42
          if (! (c != 64)) {
#line 42
            break;
          }
        } else {
#line 42
          break;
        }
      } else {
#line 42
        break;
      }
    } else {
#line 42
      break;
    }
#line 42
    tmp___4 = isgraph(c);
#line 42
    if (tmp___4) {
#line 42
      if (seq->seq.l + 1UL >= seq->seq.m) {
#line 42
        seq->seq.m = seq->seq.l + 2UL;
#line 42
        (seq->seq.m) --;
#line 42
        seq->seq.m |= seq->seq.m >> 1;
#line 42
        seq->seq.m |= seq->seq.m >> 2;
#line 42
        seq->seq.m |= seq->seq.m >> 4;
#line 42
        seq->seq.m |= seq->seq.m >> 8;
#line 42
        seq->seq.m |= seq->seq.m >> 16;
#line 42
        (seq->seq.m) ++;
#line 42
        tmp___2 = realloc((void *)seq->seq.s, seq->seq.m);
#line 42
        seq->seq.s = (char *)tmp___2;
      }
#line 42
      tmp___3 = seq->seq.l;
#line 42
      (seq->seq.l) ++;
#line 42
      *(seq->seq.s + tmp___3) = (char )c;
    }
  }
#line 42
  if (c == 62) {
#line 42
    seq->last_char = c;
  } else
#line 42
  if (c == 64) {
#line 42
    seq->last_char = c;
  }
#line 42
  *(seq->seq.s + seq->seq.l) = (char)0;
#line 42
  if (c != 43) {
#line 42
    return ((int )seq->seq.l);
  }
#line 42
  if (seq->qual.m < seq->seq.m) {
#line 42
    seq->qual.m = seq->seq.m;
#line 42
    tmp___5 = realloc((void *)seq->qual.s, seq->qual.m);
#line 42
    seq->qual.s = (char *)tmp___5;
  }
#line 42
  while (1) {
#line 42
    c = ks_getc(ks);
#line 42
    if (c != -1) {
#line 42
      if (! (c != 10)) {
#line 42
        break;
      }
    } else {
#line 42
      break;
    }
  }
#line 42
  if (c == -1) {
#line 42
    return (-2);
  }
#line 42
  while (1) {
#line 42
    c = ks_getc(ks);
#line 42
    if (c != -1) {
#line 42
      if (! (seq->qual.l < seq->seq.l)) {
#line 42
        break;
      }
    } else {
#line 42
      break;
    }
#line 42
    if (c >= 33) {
#line 42
      if (c <= 127) {
#line 42
        tmp___6 = seq->qual.l;
#line 42
        (seq->qual.l) ++;
#line 42
        *(seq->qual.s + tmp___6) = (char )((unsigned char )c);
      }
    }
  }
#line 42
  *(seq->qual.s + seq->qual.l) = (char)0;
#line 42
  seq->last_char = 0;
#line 42
  if (seq->seq.l != seq->qual.l) {
#line 42
    return (-2);
  }
#line 42
  return ((int )seq->seq.l);
}
}
#line 46 "wgsim.c"
uint8_t const   nst_nt4_table[256]  = 
#line 46
  {      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )5,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )0,      (uint8_t const   )4,      (uint8_t const   )1, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )2, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )3,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )0,      (uint8_t const   )4,      (uint8_t const   )1, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )2, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )3,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4, 
        (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4,      (uint8_t const   )4};
#line 69
double ran_normal(void) ;
#line 69 "wgsim.c"
static int iset  =    0;
#line 70 "wgsim.c"
static double gset  ;
#line 67 "wgsim.c"
double ran_normal(void) 
{ 
  double fac ;
  double rsq ;
  double v1 ;
  double v2 ;
  double tmp ;
  double tmp___0 ;
  double tmp___1 ;

  {
#line 72
  if (iset == 0) {
#line 73
    while (1) {
#line 74
      tmp = drand48();
#line 74
      v1 = 2.0 * tmp - 1.0;
#line 75
      tmp___0 = drand48();
#line 75
      v2 = 2.0 * tmp___0 - 1.0;
#line 76
      rsq = v1 * v1 + v2 * v2;
#line 73
      if (! (rsq >= 1.0)) {
#line 73
        if (! (rsq == 0.0)) {
#line 73
          break;
        }
      }
    }
#line 78
    tmp___1 = log(rsq);
#line 78
    fac = sqrt((- 2.0 * tmp___1) / rsq);
#line 79
    gset = v1 * fac;
#line 80
    iset = 1;
#line 81
    return (v2 * fac);
  } else {
#line 83
    iset = 0;
#line 84
    return (gset);
  }
}
}
#line 92 "wgsim.c"
static mut_t mutmsk  =    (mut_t )0xf000;
#line 99 "wgsim.c"
static double ERR_RATE  =    0.02;
#line 100 "wgsim.c"
static double MUT_RATE  =    0.001;
#line 101 "wgsim.c"
static double INDEL_FRAC  =    0.15;
#line 102 "wgsim.c"
static double INDEL_EXTEND  =    0.3;
#line 103 "wgsim.c"
static double MAX_N_RATIO  =    0.05;
#line 105 "wgsim.c"
void wgsim_mut_diref(kseq_t const   *ks , int is_hap , mutseq_t *hap1 , mutseq_t *hap2 ) 
{ 
  int i ;
  int deleting ;
  mutseq_t *ret[2] ;
  void *tmp ;
  void *tmp___0 ;
  int c ;
  mut_t tmp___1 ;
  mut_t tmp___2 ;
  double tmp___3 ;
  double r ;
  double tmp___4 ;
  mut_t tmp___5 ;
  int tmp___7 ;
  double tmp___8 ;
  double tmp___9 ;
  mut_t tmp___10 ;
  double tmp___12 ;
  double tmp___13 ;
  int num_ins ;
  int ins ;
  double tmp___14 ;
  double tmp___15 ;
  mut_t tmp___16 ;
  int tmp___18 ;
  double tmp___19 ;
  double tmp___20 ;
  double tmp___21 ;
  double tmp___22 ;
  double tmp___23 ;

  {
#line 107
  deleting = 0;
#line 110
  ret[0] = hap1;
#line 110
  ret[1] = hap2;
#line 111
  (ret[0])->l = (int )ks->seq.l;
#line 111
  (ret[1])->l = (int )ks->seq.l;
#line 112
  (ret[0])->m = (int )ks->seq.m;
#line 112
  (ret[1])->m = (int )ks->seq.m;
#line 113
  tmp = calloc((size_t )ks->seq.m, sizeof(mut_t ));
#line 113
  (ret[0])->s = (mut_t *)tmp;
#line 114
  tmp___0 = calloc((size_t )ks->seq.m, sizeof(mut_t ));
#line 114
  (ret[1])->s = (mut_t *)tmp___0;
#line 115
  i = 0;
#line 115
  while ((size_t___0 )i != ks->seq.l) {
#line 117
    tmp___2 = (mut_t )nst_nt4_table[(int )*(ks->seq.s + i)];
#line 117
    *((ret[1])->s + i) = tmp___2;
#line 117
    tmp___1 = tmp___2;
#line 117
    *((ret[0])->s + i) = tmp___1;
#line 117
    c = (int )tmp___1;
#line 118
    if (deleting) {
#line 119
      tmp___3 = drand48();
#line 119
      if (tmp___3 < INDEL_EXTEND) {
#line 120
        if (deleting & 1) {
#line 120
          *((ret[0])->s + i) = (mut_t )((int )*((ret[0])->s + i) | 61440);
        }
#line 121
        if (deleting & 2) {
#line 121
          *((ret[1])->s + i) = (mut_t )((int )*((ret[1])->s + i) | 61440);
        }
#line 122
        goto __Cont;
      } else {
#line 123
        deleting = 0;
      }
    }
#line 125
    if (c < 4) {
#line 125
      tmp___23 = drand48();
#line 125
      if (tmp___23 < MUT_RATE) {
#line 126
        tmp___22 = drand48();
#line 126
        if (tmp___22 >= INDEL_FRAC) {
#line 127
          tmp___4 = drand48();
#line 127
          r = tmp___4;
#line 128
          c = (c + (int )(r * 3.0 + (double )1)) & 3;
#line 129
          if (is_hap) {
#line 130
            tmp___5 = (mut_t )(57344 | c);
#line 130
            *((ret[1])->s + i) = tmp___5;
#line 130
            *((ret[0])->s + i) = tmp___5;
          } else {
#line 129
            tmp___9 = drand48();
#line 129
            if (tmp___9 < 0.333333) {
#line 130
              tmp___5 = (mut_t )(57344 | c);
#line 130
              *((ret[1])->s + i) = tmp___5;
#line 130
              *((ret[0])->s + i) = tmp___5;
            } else {
#line 132
              tmp___8 = drand48();
#line 132
              if (tmp___8 < 0.5) {
#line 132
                tmp___7 = 0;
              } else {
#line 132
                tmp___7 = 1;
              }
#line 132
              *((ret[tmp___7])->s + i) = (mut_t )(57344 | c);
            }
          }
        } else {
#line 135
          tmp___21 = drand48();
#line 135
          if (tmp___21 < 0.5) {
#line 136
            if (is_hap) {
#line 137
              tmp___10 = (mut_t )61440;
#line 137
              *((ret[1])->s + i) = tmp___10;
#line 137
              *((ret[0])->s + i) = tmp___10;
#line 138
              deleting = 3;
            } else {
#line 136
              tmp___13 = drand48();
#line 136
              if (tmp___13 < 0.333333) {
#line 137
                tmp___10 = (mut_t )61440;
#line 137
                *((ret[1])->s + i) = tmp___10;
#line 137
                *((ret[0])->s + i) = tmp___10;
#line 138
                deleting = 3;
              } else {
#line 140
                tmp___12 = drand48();
#line 140
                if (tmp___12 < 0.5) {
#line 140
                  deleting = 1;
                } else {
#line 140
                  deleting = 2;
                }
#line 141
                *((ret[deleting - 1])->s + i) = (mut_t )61440;
              }
            }
          } else {
#line 144
            num_ins = 0;
#line 144
            ins = 0;
#line 145
            while (1) {
#line 146
              num_ins ++;
#line 147
              tmp___14 = drand48();
#line 147
              ins = (ins << 2) | (int )(tmp___14 * 4.0);
#line 145
              if (num_ins < 4) {
#line 145
                tmp___15 = drand48();
#line 145
                if (! (tmp___15 < INDEL_EXTEND)) {
#line 145
                  break;
                }
              } else {
#line 145
                break;
              }
            }
#line 150
            if (is_hap) {
#line 151
              tmp___16 = (mut_t )(((num_ins << 12) | (ins << 4)) | c);
#line 151
              *((ret[1])->s + i) = tmp___16;
#line 151
              *((ret[0])->s + i) = tmp___16;
            } else {
#line 150
              tmp___20 = drand48();
#line 150
              if (tmp___20 < 0.333333) {
#line 151
                tmp___16 = (mut_t )(((num_ins << 12) | (ins << 4)) | c);
#line 151
                *((ret[1])->s + i) = tmp___16;
#line 151
                *((ret[0])->s + i) = tmp___16;
              } else {
#line 153
                tmp___19 = drand48();
#line 153
                if (tmp___19 < 0.5) {
#line 153
                  tmp___18 = 0;
                } else {
#line 153
                  tmp___18 = 1;
                }
#line 153
                *((ret[tmp___18])->s + i) = (mut_t )(((num_ins << 12) | (ins << 4)) | c);
              }
            }
          }
        }
      }
    }
    __Cont: /* CIL Label */ 
#line 115
    i ++;
  }
#line 159
  return;
}
}
#line 160 "wgsim.c"
void wgsim_print_mutref(char const   *name , kseq_t const   *ks , mutseq_t *hap1 ,
                        mutseq_t *hap2 ) 
{ 
  int i ;
  int j ;
  int c[3] ;
  int n ;
  int ins ;
  int n___0 ;
  int ins___0 ;
  int n___1 ;
  int ins___1 ;

  {
#line 162
  j = 0;
#line 163
  i = 0;
#line 163
  while ((size_t___0 )i != ks->seq.l) {
#line 165
    c[0] = (int )nst_nt4_table[(int )*(ks->seq.s + i)];
#line 166
    c[1] = (int )*(hap1->s + i);
#line 166
    c[2] = (int )*(hap2->s + i);
#line 167
    if (c[0] >= 4) {
#line 167
      goto __Cont;
    }
#line 168
    if ((c[1] & (int )mutmsk) != 0) {
#line 168
      goto _L___1;
    } else
#line 168
    if ((c[2] & (int )mutmsk) != 0) {
      _L___1: /* CIL Label */ 
#line 169
      if (c[1] == c[2]) {
#line 170
        if ((c[1] & (int )mutmsk) == 57344) {
#line 171
          printf((char const   * __restrict  )"%s\t%d\t%c\t%c\t-\n", name, i + 1,
                 (int )*("ACGTN" + c[0]), (int )*("ACGTN" + (c[1] & 0xf)));
        } else
#line 172
        if ((c[1] & (int )mutmsk) == 61440) {
#line 173
          if (i >= j) {
#line 174
            printf((char const   * __restrict  )"%s\t%d\t", name, i + 1);
#line 175
            j = i;
#line 175
            while (1) {
#line 175
              if ((size_t___0 )j < ks->seq.l) {
#line 175
                if ((int )*(hap1->s + j) == (int )*(hap2->s + j)) {
#line 175
                  if (! (((int )*(hap1->s + j) & (int )mutmsk) == 61440)) {
#line 175
                    break;
                  }
                } else {
#line 175
                  break;
                }
              } else {
#line 175
                break;
              }
#line 176
              putchar((int )*("ACGTN" + nst_nt4_table[(int )*(ks->seq.s + j)]));
#line 175
              j ++;
            }
#line 177
            printf((char const   * __restrict  )"\t-\t-\n");
          }
        } else
#line 179
        if ((c[1] & (int )mutmsk) >> 12 <= 4) {
#line 180
          printf((char const   * __restrict  )"%s\t%d\t-\t", name, i + 1);
#line 181
          n = (c[1] & (int )mutmsk) >> 12;
#line 181
          ins = c[1] >> 4;
#line 182
          while (n > 0) {
#line 183
            putchar((int )*("ACGTN" + (ins & 0x3)));
#line 184
            ins >>= 2;
#line 185
            n --;
          }
#line 187
          printf((char const   * __restrict  )"\t-\n");
        }
      } else
#line 190
      if ((c[1] & (int )mutmsk) == 57344) {
#line 191
        printf((char const   * __restrict  )"%s\t%d\t%c\t%c\t+\n", name, i + 1, (int )*("ACGTN" + c[0]),
               (int )*("XACMGRSVTWYHKDBN" + ((1 << (c[1] & 0x3)) | (1 << (c[2] & 0x3)))));
      } else
#line 190
      if ((c[2] & (int )mutmsk) == 57344) {
#line 191
        printf((char const   * __restrict  )"%s\t%d\t%c\t%c\t+\n", name, i + 1, (int )*("ACGTN" + c[0]),
               (int )*("XACMGRSVTWYHKDBN" + ((1 << (c[1] & 0x3)) | (1 << (c[2] & 0x3)))));
      } else
#line 192
      if ((c[1] & (int )mutmsk) == 61440) {
#line 193
        if (i >= j) {
#line 194
          printf((char const   * __restrict  )"%s\t%d\t", name, i + 1);
#line 195
          j = i;
#line 195
          while (1) {
#line 195
            if ((size_t___0 )j < ks->seq.l) {
#line 195
              if ((int )*(hap1->s + j) != (int )*(hap2->s + j)) {
#line 195
                if (! (((int )*(hap1->s + j) & (int )mutmsk) == 61440)) {
#line 195
                  break;
                }
              } else {
#line 195
                break;
              }
            } else {
#line 195
              break;
            }
#line 196
            putchar((int )*("ACGTN" + nst_nt4_table[(int )*(ks->seq.s + j)]));
#line 195
            j ++;
          }
#line 197
          printf((char const   * __restrict  )"\t-\t-\n");
        }
      } else
#line 199
      if ((c[2] & (int )mutmsk) == 61440) {
#line 200
        if (i >= j) {
#line 201
          printf((char const   * __restrict  )"%s\t%d\t", name, i + 1);
#line 202
          j = i;
#line 202
          while (1) {
#line 202
            if ((size_t___0 )j < ks->seq.l) {
#line 202
              if ((int )*(hap1->s + j) != (int )*(hap2->s + j)) {
#line 202
                if (! (((int )*(hap2->s + j) & (int )mutmsk) == 61440)) {
#line 202
                  break;
                }
              } else {
#line 202
                break;
              }
            } else {
#line 202
              break;
            }
#line 203
            putchar((int )*("ACGTN" + nst_nt4_table[(int )*(ks->seq.s + j)]));
#line 202
            j ++;
          }
#line 204
          printf((char const   * __restrict  )"\t-\t-\n");
        }
      } else
#line 206
      if ((c[1] & (int )mutmsk) >> 12 <= 4) {
#line 206
        if ((c[1] & (int )mutmsk) >> 12 > 0) {
#line 207
          printf((char const   * __restrict  )"%s\t%d\t-\t", name, i + 1);
#line 208
          n___0 = (c[1] & (int )mutmsk) >> 12;
#line 208
          ins___0 = c[1] >> 4;
#line 209
          while (n___0 > 0) {
#line 210
            putchar((int )*("ACGTN" + (ins___0 & 0x3)));
#line 211
            ins___0 >>= 2;
#line 212
            n___0 --;
          }
#line 214
          printf((char const   * __restrict  )"\t+\n");
        } else {
#line 206
          goto _L___0;
        }
      } else
      _L___0: /* CIL Label */ 
#line 215
      if ((c[2] & (int )mutmsk) >> 12 <= 4) {
#line 215
        goto _L;
      } else
#line 215
      if ((c[2] & (int )mutmsk) >> 12 > 0) {
        _L: /* CIL Label */ 
#line 216
        printf((char const   * __restrict  )"%s\t%d\t-\t", name, i + 1);
#line 217
        n___1 = (c[2] & (int )mutmsk) >> 12;
#line 217
        ins___1 = c[2] >> 4;
#line 218
        while (n___1 > 0) {
#line 219
          putchar((int )*("ACGTN" + (ins___1 & 0x3)));
#line 220
          ins___1 >>= 2;
#line 221
          n___1 --;
        }
#line 223
        printf((char const   * __restrict  )"\t+\n");
      }
    }
    __Cont: /* CIL Label */ 
#line 163
    i ++;
  }
#line 228
  return;
}
}
#line 230 "wgsim.c"
void wgsim_core(FILE *fpout1 , FILE *fpout2 , char const   *fn , int is_hap , uint64_t N ,
                int dist , int std_dev , int size_l , int size_r ) 
{ 
  kseq_t *ks ;
  mutseq_t rseq[2] ;
  gzFile fp_fa ;
  uint64_t tot_len ;
  uint64_t ii ;
  int i ;
  int l ;
  int n_ref ;
  char *qstr ;
  int size[2] ;
  int Q ;
  int max_size ;
  uint8_t *tmp_seq[2] ;
  mut_t *target ;
  void *tmp ;
  void *tmp___0 ;
  void *tmp___1 ;
  double tmp___2 ;
  double tmp___3 ;
  uint64_t n_pairs ;
  double ran ;
  int d ;
  int pos ;
  int s[2] ;
  int is_flip ;
  int n_sub[2] ;
  int n_indel[2] ;
  int n_err[2] ;
  int ext_coor[2] ;
  int j ;
  int k ;
  FILE *fpo[2] ;
  double tmp___4 ;
  double tmp___5 ;
  int tmp___7 ;
  double tmp___8 ;
  int c ;
  int mut_type ;
  int tmp___9 ;
  int n ;
  int ins ;
  int tmp___10 ;
  int tmp___11 ;
  int c___0 ;
  int mut_type___0 ;
  int tmp___12 ;
  int n___0 ;
  int ins___0 ;
  int tmp___13 ;
  int tmp___14 ;
  int n_n ;
  int c___1 ;
  double tmp___15 ;
  int tmp___16 ;

  {
#line 242
  if (size_l > size_r) {
#line 242
    l = size_l;
  } else {
#line 242
    l = size_r;
  }
#line 243
  tmp = calloc((size_t )(l + 1), (size_t )1);
#line 243
  qstr = (char *)tmp;
#line 244
  tmp___0 = calloc((size_t )(l + 2), (size_t )1);
#line 244
  tmp_seq[0] = (uint8_t *)tmp___0;
#line 245
  tmp___1 = calloc((size_t )(l + 2), (size_t )1);
#line 245
  tmp_seq[1] = (uint8_t *)tmp___1;
#line 246
  size[0] = size_l;
#line 246
  size[1] = size_r;
#line 247
  if (size_l > size_r) {
#line 247
    max_size = size_l;
  } else {
#line 247
    max_size = size_r;
  }
#line 249
  if (ERR_RATE == 0.0) {
#line 249
    Q = 'I';
  } else {
#line 249
    tmp___2 = log(ERR_RATE);
#line 249
    tmp___3 = log(10.0);
#line 249
    Q = (int )((- 10.0 * tmp___2) / tmp___3 + 0.499) + 33;
  }
#line 251
  fp_fa = gzopen(fn, (char const   *)"r");
#line 252
  ks = kseq_init(fp_fa);
#line 253
  n_ref = 0;
#line 253
  tot_len = (uint64_t )n_ref;
#line 254
  fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"[%s] calculating the total length of the reference sequence...\n",
          "wgsim_core");
#line 255
  while (1) {
#line 255
    l = kseq_read(ks);
#line 255
    if (! (l >= 0)) {
#line 255
      break;
    }
#line 256
    tot_len += (uint64_t )l;
#line 257
    n_ref ++;
  }
#line 259
  fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"[%s] %d sequences, total length: %llu\n",
          "wgsim_core", n_ref, (long long )tot_len);
#line 260
  kseq_destroy(ks);
#line 261
  gzclose(fp_fa);
#line 263
  fp_fa = gzopen(fn, (char const   *)"r");
#line 264
  ks = kseq_init(fp_fa);
#line 265
  while (1) {
#line 265
    l = kseq_read(ks);
#line 265
    if (! (l >= 0)) {
#line 265
      break;
    }
#line 266
    n_pairs = (uint64_t )(((long double )l / (long double )tot_len) * (long double )N + (long double )0.5);
#line 267
    if (l < dist + 3 * std_dev) {
#line 268
      continue;
    }
#line 272
    wgsim_mut_diref((kseq_t const   *)ks, is_hap, rseq, rseq + 1);
#line 274
    ii = (uint64_t )0;
#line 274
    while (ii != n_pairs) {
#line 276
      is_flip = 0;
#line 280
      while (1) {
#line 281
        ran = ran_normal();
#line 282
        ran = ran * (double )std_dev + (double )dist;
#line 283
        d = (int )(ran + 0.5);
#line 284
        if (d > max_size) {
#line 284
          d = d;
        } else {
#line 284
          d = max_size;
        }
#line 285
        tmp___4 = drand48();
#line 285
        pos = (int )((double )((l - d) + 1) * tmp___4);
#line 280
        if (! (pos < 0)) {
#line 280
          if (! ((size_t___0 )pos >= ks->seq.l)) {
#line 280
            if (! ((size_t___0 )((pos + d) - 1) >= ks->seq.l)) {
#line 280
              break;
            }
          }
        }
      }
#line 289
      tmp___5 = drand48();
#line 289
      if (tmp___5 < 0.5) {
#line 290
        fpo[0] = fpout1;
#line 290
        fpo[1] = fpout2;
#line 291
        s[0] = size[0];
#line 291
        s[1] = size[1];
      } else {
#line 293
        fpo[1] = fpout1;
#line 293
        fpo[0] = fpout2;
#line 294
        s[1] = size[0];
#line 294
        s[0] = size[1];
#line 295
        is_flip = 1;
      }
#line 299
      tmp___8 = drand48();
#line 299
      if (tmp___8 < 0.5) {
#line 299
        tmp___7 = 0;
      } else {
#line 299
        tmp___7 = 1;
      }
#line 299
      target = rseq[tmp___7].s;
#line 300
      n_err[1] = 0;
#line 300
      n_err[0] = n_err[1];
#line 300
      n_indel[1] = n_err[0];
#line 300
      n_indel[0] = n_indel[1];
#line 300
      n_sub[1] = n_indel[0];
#line 300
      n_sub[0] = n_sub[1];
#line 324
      while (1) {
#line 324
        i = pos;
#line 324
        k = 0;
#line 324
        ext_coor[0] = -10;
#line 324
        while (1) {
#line 324
          if (i >= 0) {
#line 324
            if ((size_t___0 )i < ks->seq.l) {
#line 324
              if (! (k < s[0])) {
#line 324
                break;
              }
            } else {
#line 324
              break;
            }
          } else {
#line 324
            break;
          }
#line 324
          c = (int )*(target + i);
#line 324
          mut_type = c & (int )mutmsk;
#line 324
          if (ext_coor[0] < 0) {
#line 324
            if (mut_type != 0) {
#line 324
              if (mut_type != 57344) {
#line 324
                goto __Cont;
              }
            }
#line 324
            ext_coor[0] = i;
          }
#line 324
          if (mut_type == 61440) {
#line 324
            (n_indel[0]) ++;
          } else
#line 324
          if (mut_type == 0) {
#line 324
            goto _L;
          } else
#line 324
          if (mut_type == 57344) {
            _L: /* CIL Label */ 
#line 324
            tmp___9 = k;
#line 324
            k ++;
#line 324
            *(tmp_seq[0] + tmp___9) = (uint8_t )(c & 0xf);
#line 324
            if (mut_type == 57344) {
#line 324
              (n_sub[0]) ++;
            }
          } else {
#line 324
            (n_indel[0]) ++;
#line 324
            tmp___10 = k;
#line 324
            k ++;
#line 324
            *(tmp_seq[0] + tmp___10) = (uint8_t )(c & 0xf);
#line 324
            n = mut_type >> 12;
#line 324
            ins = c >> 4;
#line 324
            while (1) {
#line 324
              if (n > 0) {
#line 324
                if (! (k < s[0])) {
#line 324
                  break;
                }
              } else {
#line 324
                break;
              }
#line 324
              tmp___11 = k;
#line 324
              k ++;
#line 324
              *(tmp_seq[0] + tmp___11) = (uint8_t )(ins & 0x3);
#line 324
              n --;
#line 324
              ins >>= 2;
            }
          }
          __Cont: /* CIL Label */ 
#line 324
          i ++;
        }
#line 324
        if (k != s[0]) {
#line 324
          ext_coor[0] = -10;
        }
#line 324
        break;
      }
#line 325
      while (1) {
#line 325
        i = (pos + d) - 1;
#line 325
        k = 0;
#line 325
        ext_coor[1] = -10;
#line 325
        while (1) {
#line 325
          if (i >= 0) {
#line 325
            if ((size_t___0 )i < ks->seq.l) {
#line 325
              if (! (k < s[1])) {
#line 325
                break;
              }
            } else {
#line 325
              break;
            }
          } else {
#line 325
            break;
          }
#line 325
          c___0 = (int )*(target + i);
#line 325
          mut_type___0 = c___0 & (int )mutmsk;
#line 325
          if (ext_coor[1] < 0) {
#line 325
            if (mut_type___0 != 0) {
#line 325
              if (mut_type___0 != 57344) {
#line 325
                goto __Cont___0;
              }
            }
#line 325
            ext_coor[1] = i;
          }
#line 325
          if (mut_type___0 == 61440) {
#line 325
            (n_indel[1]) ++;
          } else
#line 325
          if (mut_type___0 == 0) {
#line 325
            goto _L___0;
          } else
#line 325
          if (mut_type___0 == 57344) {
            _L___0: /* CIL Label */ 
#line 325
            tmp___12 = k;
#line 325
            k ++;
#line 325
            *(tmp_seq[1] + tmp___12) = (uint8_t )(c___0 & 0xf);
#line 325
            if (mut_type___0 == 57344) {
#line 325
              (n_sub[1]) ++;
            }
          } else {
#line 325
            (n_indel[1]) ++;
#line 325
            tmp___13 = k;
#line 325
            k ++;
#line 325
            *(tmp_seq[1] + tmp___13) = (uint8_t )(c___0 & 0xf);
#line 325
            n___0 = mut_type___0 >> 12;
#line 325
            ins___0 = c___0 >> 4;
#line 325
            while (1) {
#line 325
              if (n___0 > 0) {
#line 325
                if (! (k < s[1])) {
#line 325
                  break;
                }
              } else {
#line 325
                break;
              }
#line 325
              tmp___14 = k;
#line 325
              k ++;
#line 325
              *(tmp_seq[1] + tmp___14) = (uint8_t )(ins___0 & 0x3);
#line 325
              n___0 --;
#line 325
              ins___0 >>= 2;
            }
          }
          __Cont___0: /* CIL Label */ 
#line 325
          i --;
        }
#line 325
        if (k != s[1]) {
#line 325
          ext_coor[1] = -10;
        }
#line 325
        break;
      }
#line 326
      k = 0;
#line 326
      while (k < s[1]) {
#line 326
        if ((int )*(tmp_seq[1] + k) < 4) {
#line 326
          *(tmp_seq[1] + k) = (uint8_t )(3 - (int )*(tmp_seq[1] + k));
        } else {
#line 326
          *(tmp_seq[1] + k) = (uint8_t )4;
        }
#line 326
        k ++;
      }
#line 327
      if (ext_coor[0] < 0) {
#line 328
        ii --;
#line 329
        goto __Cont___1;
      } else
#line 327
      if (ext_coor[1] < 0) {
#line 328
        ii --;
#line 329
        goto __Cont___1;
      }
#line 333
      j = 0;
#line 333
      while (j < 2) {
#line 334
        n_n = 0;
#line 335
        i = 0;
#line 335
        while (i < s[j]) {
#line 336
          c___1 = (int )*(tmp_seq[j] + i);
#line 337
          if (c___1 >= 4) {
#line 338
            c___1 = 4;
#line 339
            n_n ++;
          } else {
#line 340
            tmp___15 = drand48();
#line 340
            if (tmp___15 < ERR_RATE) {
#line 342
              c___1 = (c___1 + 1) & 3;
#line 343
              (n_err[j]) ++;
            }
          }
#line 345
          *(tmp_seq[j] + i) = (uint8_t )c___1;
#line 335
          i ++;
        }
#line 347
        if ((double )n_n / (double )s[j] > MAX_N_RATIO) {
#line 347
          break;
        }
#line 333
        j ++;
      }
#line 349
      if (j < 2) {
#line 350
        ii --;
#line 351
        goto __Cont___1;
      }
#line 355
      j = 0;
#line 355
      while (j < 2) {
#line 356
        i = 0;
#line 356
        while (i < s[j]) {
#line 356
          *(qstr + i) = (char )Q;
#line 356
          i ++;
        }
#line 357
        *(qstr + i) = (char)0;
#line 358
        if (j == 0) {
#line 358
          tmp___16 = is_flip + 1;
        } else {
#line 358
          tmp___16 = 2 - is_flip;
        }
#line 358
        fprintf((FILE * __restrict  )fpo[j], (char const   * __restrict  )"@%s_%u_%u_%d:%d:%d_%d:%d:%d_%llx/%d\n",
                ks->name.s, ext_coor[0] + 1, ext_coor[1] + 1, n_err[0], n_sub[0],
                n_indel[0], n_err[1], n_sub[1], n_indel[1], (long long )ii, tmp___16);
#line 361
        i = 0;
#line 361
        while (i < s[j]) {
#line 362
          fputc((int )*("ACGTN" + (int )*(tmp_seq[j] + i)), fpo[j]);
#line 361
          i ++;
        }
#line 363
        fprintf((FILE * __restrict  )fpo[j], (char const   * __restrict  )"\n+\n%s\n",
                qstr);
#line 355
        j ++;
      }
      __Cont___1: /* CIL Label */ 
#line 274
      ii ++;
    }
#line 366
    free((void *)rseq[0].s);
#line 366
    free((void *)rseq[1].s);
  }
#line 368
  kseq_destroy(ks);
#line 369
  gzclose(fp_fa);
#line 370
  free((void *)qstr);
#line 371
  free((void *)tmp_seq[0]);
#line 371
  free((void *)tmp_seq[1]);
#line 372
  return;
}
}
#line 374 "wgsim.c"
static int simu_usage(void) 
{ 


  {
#line 376
  fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"\n");
#line 377
  fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"Program: wgsim (short read simulator)\n");
#line 378
  fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"Version: %s\n",
          "0.3.1-r13");
#line 379
  fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"Contact: Heng Li <lh3@sanger.ac.uk>\n\n");
#line 380
  fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"Usage:   wgsim [options] <in.ref.fa> <out.read1.fq> <out.read2.fq>\n\n");
#line 381
  fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"Options: -e FLOAT      base error rate [%.3f]\n",
          ERR_RATE);
#line 382
  fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"         -d INT        outer distance between the two ends [500]\n");
#line 383
  fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"         -s INT        standard deviation [50]\n");
#line 384
  fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"         -N INT        number of read pairs [1000000]\n");
#line 385
  fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"         -1 INT        length of the first read [70]\n");
#line 386
  fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"         -2 INT        length of the second read [70]\n");
#line 387
  fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"         -r FLOAT      rate of mutations [%.4f]\n",
          MUT_RATE);
#line 388
  fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"         -R FLOAT      fraction of indels [%.2f]\n",
          INDEL_FRAC);
#line 389
  fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"         -X FLOAT      probability an indel is extended [%.2f]\n",
          INDEL_EXTEND);
#line 390
  fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"         -S INT        seed for random generator [-1]\n");
#line 391
  fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"         -A FLOAT      disgard if the fraction of ambiguous bases higher than FLOAT [%.2f]\n",
          MAX_N_RATIO);
#line 392
  fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"         -h            haplotype mode\n");
#line 393
  fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"\n");
#line 394
  return (1);
}
}
#line 397 "wgsim.c"
int main(int argc , char **argv ) 
{ 
  int64_t N ;
  int dist ;
  int std_dev ;
  int c ;
  int size_l ;
  int size_r ;
  int is_hap ;
  FILE *fpout1 ;
  FILE *fpout2 ;
  int seed ;
  int tmp ;
  int tmp___0 ;
  time_t tmp___1 ;

  {
#line 400
  is_hap = 0;
#line 402
  seed = -1;
#line 404
  N = (int64_t )1000000;
#line 404
  dist = 500;
#line 404
  std_dev = 50;
#line 405
  size_r = 70;
#line 405
  size_l = size_r;
#line 406
  while (1) {
#line 406
    c = getopt(argc, (char **)argv, (char const   *)"e:d:s:N:1:2:r:R:hX:S:A:");
#line 406
    if (! (c >= 0)) {
#line 406
      break;
    }
#line 407
    switch (c) {
    case 100: 
#line 408
    dist = atoi((char const   *)optarg);
#line 408
    break;
    case 115: 
#line 409
    std_dev = atoi((char const   *)optarg);
#line 409
    break;
    case 78: 
#line 410
    tmp = atoi((char const   *)optarg);
#line 410
    N = (int64_t )tmp;
#line 410
    break;
    case 49: 
#line 411
    size_l = atoi((char const   *)optarg);
#line 411
    break;
    case 50: 
#line 412
    size_r = atoi((char const   *)optarg);
#line 412
    break;
    case 101: 
#line 413
    ERR_RATE = atof((char const   *)optarg);
#line 413
    break;
    case 114: 
#line 414
    MUT_RATE = atof((char const   *)optarg);
#line 414
    break;
    case 82: 
#line 415
    INDEL_FRAC = atof((char const   *)optarg);
#line 415
    break;
    case 88: 
#line 416
    INDEL_EXTEND = atof((char const   *)optarg);
#line 416
    break;
    case 65: 
#line 417
    MAX_N_RATIO = atof((char const   *)optarg);
#line 417
    break;
    case 83: 
#line 418
    seed = atoi((char const   *)optarg);
#line 418
    break;
    case 104: 
#line 419
    is_hap = 1;
#line 419
    break;
    }
  }
#line 422
  if (argc - optind < 3) {
#line 422
    tmp___0 = simu_usage();
#line 422
    return (tmp___0);
  }
#line 423
  fpout1 = fopen((char const   * __restrict  )*(argv + (optind + 1)), (char const   * __restrict  )"w");
#line 424
  fpout2 = fopen((char const   * __restrict  )*(argv + (optind + 2)), (char const   * __restrict  )"w");
#line 425
  if (! fpout1) {
#line 426
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"[wgsim] file open error\n");
#line 427
    return (1);
  } else
#line 425
  if (! fpout2) {
#line 426
    fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"[wgsim] file open error\n");
#line 427
    return (1);
  }
#line 429
  if (seed <= 0) {
#line 429
    tmp___1 = time((time_t *)0);
#line 429
    seed = (int )(tmp___1 & 2147483647LL);
  }
#line 430
  fprintf((FILE * __restrict  )stderr, (char const   * __restrict  )"[wgsim] seed = %d\n",
          seed);
#line 431
  srand48((long )seed);
#line 432
  wgsim_core(fpout1, fpout2, (char const   *)*(argv + optind), is_hap, (uint64_t )N,
             dist, std_dev, size_l, size_r);
#line 434
  fclose(fpout1);
#line 434
  fclose(fpout2);
#line 435
  return (0);
}
}
